<?php
/**
 * @file
 * CultureFeed Social adds the ability to social actions (example like, comments, follow) on culturefeed items like events, productions, pages...
 */

module_load_include('inc', 'culturefeed_social', 'includes/helpers');

define('CULTUREFEED_SOCIAL_BLOCK_USER_ACTIVITIES_COUNT', 10);

/**
 * Implements hook_menu().
 */
function culturefeed_social_menu() {

  $items = array();
  $items['culturefeed/ajax/user/activities'] = array(
    'page callback' => 'culturefeed_social_page_ajax_get_activities',
    'access arguments' => array('access content'),
    'type' => MENU_CALLBACK,
    'file' => 'includes/pages.inc',
  );

  $items['admin/config/services/culturefeed_social'] = array(
    'title' => 'Culture Feed Social',
    'description' => 'Change Culture Feed Social settings',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('culturefeed_social_admin_settings_form'),
    'access arguments' => array('administer site configuration'),
    'file' => 'includes/admin.inc',
  );

  return $items;

}

/**
 * Implements hook_theme().
 */
function culturefeed_social_theme() {

  $path = drupal_get_path('module', 'culturefeed_social') . '/theme';

  return array(

    'culturefeed_social_user_activity_list' => array(
      'variables' => array(
        'activities' => array(),
        'class' => NULL,
        'pager_path' => NULL,
      ),
      'path' => $path,
      'file' => 'theme.inc',
      'template' => 'culturefeed-social-user-activity-list',
    ),
    'culturefeed_social_user_activity_summary' => array(
      'variables' => array(
        'activity' => NULL,
        'uid' => 0,
      ),
      'template' => 'culturefeed-social-user-activity-summary',
      'path' => $path,
      'file' => 'theme.inc',
    ),

  );

}

/**
 * Implements hook_block_info().
 */
function culturefeed_social_block_info() {

  $blocks = array();

  $blocks['user-activities'] = array(
    'info' => t('User activities'),
    'cache' => DRUPAL_NO_CACHE,
  );

  return $blocks;

}

/**
 * Implements hook_block_view().
 */
function culturefeed_social_block_view($delta) {

  module_load_include('inc', 'culturefeed_social', 'includes/blocks');
  $block = array();

  switch ($delta) {

    case 'user-activities':
      $account = menu_get_object('user');
      return culturefeed_social_block_user_activities($account);

  }

  return $block;

}